# SPDX-License-Identifier: MIT


"""Zeros of `Ai(x)` and `Ai'(x)`
Ref: https://dlmf.nist.gov/9.9#T1
"""
const DLMF_TABLE_9_9_1 = [
#   k,    a_k,           Ai'(a_k),       a'_k,           Ai(a'_k)
    1    -2.33810_74105  0.70121_08227   -1.01879_29716  0.53565_66560;
    2    -4.08794_94441 -0.80311_13697   -3.24819_75822 -0.41901_54780;
    3    -5.52055_98281  0.86520_40259   -4.82009_92112  0.38040_64686;
    4    -6.78670_80901 -0.91085_07370   -6.16330_73556 -0.35790_79437;
    5    -7.94413_35871  0.94733_57094   -7.37217_72550  0.34230_12444;
    6    -9.02265_08533 -0.97792_28086   -8.48848_67340 -0.33047_62291;
    7   -10.04017_43416  1.00437_01227   -9.53544_90524  0.32102_22882;
    8   -11.00852_43037 -1.02773_86888  -10.52766_03970 -0.31318_53910;
    9   -11.93601_55632  1.04872_06486  -11.47505_66335  0.30651_72939;
   10   -12.82877_67529 -1.06779_38592  -12.38478_83718 -0.30073_08293;
]

@testset "ai_zeros" begin
    @test_throws DomainError ai_zeros(-1)

    @test ai_zeros(0) == (Float64[], Float64[], Float64[], Float64[])

    a, da, ai, dai = ai_zeros(10)
    @test isapprox(DLMF_TABLE_9_9_1[:,2] , a)
    @test isapprox(DLMF_TABLE_9_9_1[:,4] , da)
    @test isapprox(DLMF_TABLE_9_9_1[:,5] , ai)
    @test isapprox(DLMF_TABLE_9_9_1[:,3] , dai)
end


"""Zeros of `Bi(x)` and `Bi'(x)`
Ref: https://dlmf.nist.gov/9.9#T2
"""
const DLMF_TABLE_9_9_2 = [
#    k,   b_k,           Bi'(b_k),        b'_k,          Bi(b'_k)
     1   -1.17371_32227  0.60195_78880   -2.29443_96826 -0.45494_43836;
     2   -3.27109_33028 -0.76031_01415   -4.07315_50891  0.39652_28361;
     3   -4.83073_78417  0.83699_10126   -5.51239_57297 -0.36796_91615;
     4   -6.16985_21283 -0.88947_99014   -6.78129_44460  0.34949_91168;
     5   -7.37676_20794  0.92998_36386   -7.94017_86892 -0.33602_62401;
     6   -8.49194_88465 -0.96323_44302   -9.01958_33588  0.32550_97364;
     7   -9.53819_43793  0.99158_63705  -10.03769_63349 -0.31693_46537;
     8  -10.52991_35067 -1.01638_96592  -11.00646_26677  0.30972_59408;
     9  -11.47695_35513  1.03849_42860  -11.93426_16450 -0.30352_76648;
    10  -12.38641_71386 -1.05847_18444  -12.82725_83092  0.29810_49111;
]

@testset "bi_zeros" begin
    @test_throws DomainError bi_zeros(-1)

    @test bi_zeros(0) == (Float64[], Float64[], Float64[], Float64[])
    
    b, db, bi, dbi = bi_zeros(10)
    @test isapprox(DLMF_TABLE_9_9_2[:,2] , b)
    @test isapprox(DLMF_TABLE_9_9_2[:,4] , db)
    @test isapprox(DLMF_TABLE_9_9_2[:,5] , bi)
    @test isapprox(DLMF_TABLE_9_9_2[:,3] , dbi)
end
